# Safha - Lessons Learned

**Maintained By**: m7zm (CEO) + The Eye (Audit)
**Last Updated**: 2026-01-20

---

## Active Lessons

| ID | Lesson | Category | Date |
|----|--------|----------|------|
| SAFHA-001 | Never use fake social proof - Mohammad immediately rejects dishonesty | Business | 2026-01-12 |
| SAFHA-002 | Pricing must be consistent everywhere (value stack, buttons, payment) | Design | 2026-01-12 |
| SAFHA-003 | Always test RSS URLs before adding - many return 404/403 or are blocked by Cloudflare | Backend | 2026-01-15 |
| SAFHA-004 | Use Google News RSS as workaround for sites that block direct RSS access | Backend | 2026-01-15 |
| SAFHA-005 | Two tables exist: `sources` (display) vs `rss_sources` (RSS URLs for backend) - don't confuse them | Backend | 2026-01-15 |
| SAFHA-006 | Use wsrv.nl server-side blur for Spotify-style backgrounds - no client dependencies needed | Frontend | 2026-01-14 |
| SAFHA-007 | Extract videos from article HTML not just RSS - og:video, twitter:player, iframes, video tags | Backend | 2026-01-14 |
| SAFHA-008 | Use `createLogger()` from lib/debug.ts for all logging - auto-suppressed in production | Code Quality | 2026-01-14 |
| SAFHA-009 | All interactive elements need bilingual accessibility labels (en/ar) with accessibilityRole | Accessibility | 2026-01-14 |
| SAFHA-010 | Never use raw console.* in client code - causes data leakage, bundle bloat, perf issues | Code Quality | 2026-01-14 |
| SAFHA-011 | Explore vs Interests modes need different queries - Explore=all stories, Interests=unseen only | Frontend | 2026-01-15 |
| SAFHA-012 | Use local font files (assets/fonts/) instead of @expo-google-fonts for offline reliability | Frontend | 2026-01-15 |
| SAFHA-013 | app.json web output "single" not "static" to prevent SSR crashes with AsyncStorage | Config | 2026-01-15 |
| SAFHA-014 | Empty state messages must consider feedMode - Explore has no topic filtering | Frontend | 2026-01-15 |
| SAFHA-015 | Migrations must be manually run in Supabase SQL Editor - they don't auto-apply to production | Backend | 2026-01-15 |
| SAFHA-016 | Edge Functions need CLAUDE_API_KEY + FUNCTION_SECRET secrets set in Supabase Dashboard | Backend | 2026-01-15 |
| SAFHA-017 | Cron jobs need FUNCTION_SECRET header for pg_net HTTP auth - service role key can't be set directly | Backend | 2026-01-15 |
| SAFHA-018 | RSS sources deactivated during testing remain `is_active=false` - always verify active count | Backend | 2026-01-15 |
| SAFHA-019 | 39 Arabic sources active (English sources disabled per CEO decision 2026-01-19) | Backend | 2026-01-15 |
| SAFHA-020 | 16 user interests confirmed - use topic_ids array to link RSS sources to interests | Backend | 2026-01-15 |
| SAFHA-021 | RSS source topic_ids must flow through pipeline: rss_sources -> raw_articles -> stories | Backend | 2026-01-15 |
| SAFHA-022 | When feed shows fewer stories than expected, check server vs client separately using REST API | Debug | 2026-01-16 |
| SAFHA-023 | Database has 816 approved stories - Interests mode may filter differently than Explore mode | Backend | 2026-01-16 |
| SAFHA-024 | Feed position (currentStoryIndex) must be in Zustand partialize list for persistence | Frontend | 2026-01-16 |
| SAFHA-025 | Anonymous users should NOT have localHistory filter - they can't track "unseen" without account | Frontend | 2026-01-16 |
| SAFHA-026 | Keep SQL ORDER BY clauses simple - avoid tiering complexity that confuses debugging | Backend | 2026-01-16 |
| SAFHA-027 | pg_cron with pg_net: current_setting() doesn't work - use literal JSON string for headers | Backend | 2026-01-16 |
| SAFHA-028 | Edge Functions via pg_net need BOTH x-function-secret AND Authorization Bearer headers | Backend | 2026-01-16 |
| SAFHA-029 | Sort by created_at not published_at for "newest first" feed - RSS feeds have old article dates | Backend | 2026-01-16 |
| SAFHA-030 | Google News RSS provides redirect URLs (news.google.com/articles/...) - must follow to get actual article | Backend | 2026-01-16 |
| SAFHA-031 | Google News articles need actual URL for image/content extraction - redirect pages have no og:image | Backend | 2026-01-16 |
| SAFHA-032 | useMemo dependencies should only include data that affects output - exclude isLoading/isError states | Performance | 2026-01-16 |
| SAFHA-033 | Image fallback chains should use single state instead of multiple booleans to prevent cascading re-renders | Performance | 2026-01-16 |
| SAFHA-034 | Debounce image prefetch (300ms) to prevent network congestion during rapid scrolling | Performance | 2026-01-16 |
| SAFHA-035 | Animated.loop() must have `iterations` limit or isMounted check to prevent memory leaks | Performance | 2026-01-16 |
| SAFHA-036 | Clamp PagerView initialPage to valid range to prevent white screen on resume | Performance | 2026-01-16 |
| SAFHA-037 | External API calls in Edge Functions need timeout (AbortController) - can hang indefinitely | Backend | 2026-01-16 |
| SAFHA-038 | Auto-reset stuck "processing" articles older than 5 min - prevents permanent stuck state | Backend | 2026-01-16 |
| SAFHA-039 | Keep Edge Function batch sizes small (10 not 25) - stay within 60-second timeout limit | Backend | 2026-01-16 |
| SAFHA-040 | All 16 topics must have at least one RSS source with topic_ids assigned | Backend | 2026-01-16 |
| SAFHA-041 | WhatsApp Business API requires Meta Business verification from ALL providers - no shortcuts | Integration | 2026-01-16 |
| SAFHA-042 | Taqnyat API key: Developers -> Applications -> create app -> Bearer Token column (docs required first) | Integration | 2026-01-16 |
| SAFHA-043 | For MVP, push notifications or email (Resend) are easier than WhatsApp - no business docs needed | Integration | 2026-01-16 |
| SAFHA-044 | Twilio WhatsApp has sandbox mode for testing before full Meta Business verification | Integration | 2026-01-16 |
| SAFHA-045 | generate-digest Edge Function needs TAQNYAT_API_KEY secret for WhatsApp messages | Backend | 2026-01-16 |
| SAFHA-046 | WhatsApp digest requires profile.phone_number + profile.whatsapp_opted_in=true | Backend | 2026-01-16 |
| SAFHA-047 | React memo() with object props (colors from useTheme) needs custom comparator - reference changes break memo | Performance | 2026-01-16 |
| SAFHA-048 | Switch components can revert if useEffect syncs from store - use one-time hasLoadedPrefs ref pattern | Frontend | 2026-01-16 |
| SAFHA-049 | Always verify database schema matches code before marking features "resolved" | Backend | 2026-01-17 |
| SAFHA-050 | Cron jobs need monitoring - query cron.job_run_details for failure detection | Backend | 2026-01-17 |
| SAFHA-051 | Circuit breaker pattern prevents cascade failures - trip after N consecutive errors | Backend | 2026-01-17 |
| SAFHA-052 | Health check endpoints enable external monitoring (UptimeRobot, etc.) | Backend | 2026-01-17 |
| SAFHA-053 | For cron-based pipelines, let automation handle backlog - don't manually intervene unless business-critical | Operations | 2026-01-19 |
| SAFHA-054 | Safha is Arabic-only - all English sources disabled per CEO decision | Business | 2026-01-19 |
| SAFHA-055 | Remove unused AI output fields to reduce token cost - 62% savings by dropping bilingual + why_it_matters | Cost Optimization | 2026-01-20 |

---

## Lesson Details

### SAFHA-001: Never Use Fake Social Proof
- **Context**: Subscription page had "32,000+ professionals" claim with no basis
- **Lesson**: Mohammad values honesty above conversion. Use real value props instead.
- **Recorded By**: The Eye

### SAFHA-002: Pricing Consistency is Non-Negotiable
- **Context**: Page showed SAR 16 in value stack but SAR 25 on button. Confusing.
- **Lesson**: All price references must match. One source of truth for pricing.
- **Recorded By**: m7zm

### SAFHA-003: Always Test RSS URLs Before Adding
- **Context**: Added 73 Arabic RSS sources, but 42 were broken (404/403/timeout/Cloudflare blocked)
- **Lesson**: Always curl-test RSS URLs before adding to database. Many sites block automated requests.

### SAFHA-004: Google News RSS Workaround
- **Context**: Major Arabic news sites (Al Arabiya, Al Jazeera, Sky News) block direct RSS access
- **Lesson**: Use `https://news.google.com/rss/search?q=site:DOMAIN&hl=ar&gl=SA&ceid=SA:ar` as workaround
- **Working Sources via Google News**: Al Arabiya, Al Jazeera, Sky News, Al Sharq Al Awsat, Kooora, FilGoal, MBC

### SAFHA-005: Sources vs RSS Sources Tables
- **Context**: App showed sources but feed was empty - `rss_sources` table was empty
- **Lesson**: `sources` table is for display/UI, `rss_sources` table is for RSS fetching backend. Both need data.

### SAFHA-006: wsrv.nl Server-Side Blur
- **Context**: Images were zoomed too much with `fit=cover`. Needed Spotify-style blurred background.
- **Lesson**: Use wsrv.nl `&blur=15` parameter for server-side blur. No need for expo-blur or client-side processing.
- **Pattern**: Blurred background (cover) + Sharp foreground (contain) = full image with no empty edges

### SAFHA-007: Extract Videos from HTML
- **Context**: RSS feeds rarely include video URLs. Articles with embedded videos were missed.
- **Lesson**: Scan article HTML for videos: og:video meta, twitter:player, `<video>` tags, `<iframe>` embeds
- **Platforms**: YouTube, Vimeo, Dailymotion, direct MP4

### SAFHA-008: Use createLogger() for All Logging
- **Context**: The Eye audit found 150+ console.* statements leaking data in production
- **Pattern**:
  ```typescript
  import { createLogger } from '@/lib/debug';
  const log = createLogger('ComponentName');
  log.debug('message');  // Suppressed in production
  ```
- **Recorded By**: The Eye

### SAFHA-009: Bilingual Accessibility Labels Required
- **Context**: StoryCard buttons had no screen reader support
- **Pattern**:
  ```tsx
  <TouchableOpacity
    accessibilityRole="button"
    accessibilityLabel={isArabic ? 'Arabic label' : 'English label'}
  >
  ```
- **Recorded By**: The Eye

### SAFHA-010: No Raw Console Statements in Client Code
- **Context**: Production app was logging user data, API responses, and debug info
- **Fix**: Use lib/debug.ts which checks `__DEV__` and suppresses in production
- **Recorded By**: The Eye

### SAFHA-011: Explore vs Interests Query Selection
- **Context**: Explore feed showed 0 stories even after switching to regularQuery
- **Fix**: TWO layers of filtering existed:
  1. Query selection - Explore should use `regularQuery`
  2. `localHistory` filter - skip for logged-in users
- **Files**: `app/(tabs)/feed.tsx`, `hooks/useStories.ts`

### SAFHA-012: Use Local Font Files
- **Context**: @expo-google-fonts/tajawal required network to load fonts
- **Fix**: `require('../assets/fonts/Tajawal-*.ttf')` instead of npm package

### SAFHA-013: Web Output Config for SSR
- **Context**: `"output": "static"` in app.json caused SSR crash with AsyncStorage
- **Fix**: Use `"output": "single"` in app.json

### SAFHA-014: Empty State Must Consider feedMode
- **Context**: Explore mode showed "No stories for this topic" but Explore has NO topic filtering
- **Fix**: Check `feedMode === 'explore'` for appropriate messages

### SAFHA-015: Migrations Don't Auto-Apply to Production
- **Context**: `rss_sources` table was empty despite migrations existing
- **Fix**: Run migration SQL manually in Supabase Dashboard > SQL Editor
- **Recorded By**: The Eye

### SAFHA-016: Edge Function Secrets Required
- **Context**: process-articles returning "Unauthorized"
- **Required Secrets**:
  - `CLAUDE_API_KEY` - for AI summarization
  - `FUNCTION_SECRET` - for manual/cron authentication
- **Recorded By**: The Eye

### SAFHA-017: Cron Jobs Need FUNCTION_SECRET for HTTP Auth
- **Context**: pg_net can't use `app.settings.service_role_key` - permission denied
- **Fix**: Add `x-function-secret` header to all cron HTTP calls
- **File**: `supabase/CRON_JOBS.sql`

### SAFHA-018: RSS Sources Deactivated During Testing
- **Context**: Sources tested during RSS URL verification were disabled if broken
- **To Re-enable**: `UPDATE rss_sources SET is_active = true WHERE is_active = false;`

### SAFHA-019: RSS Source Verification Results (2026-01-15)
- **Working (39)**: 39 Arabic (English sources disabled 2026-01-19)
- **Broken (78)**: 42 Arabic + 36 English (all disabled)

### SAFHA-020: User's 16 Confirmed Interests
| # | Interest | Topic Slug |
|---|----------|------------|
| 1 | Politics | `politics` |
| 2 | Business & Economy | `economy` |
| 3 | Sports | `sports` |
| 4 | Technology | `technology` |
| 5 | Science | `science` |
| 6 | Travel | `travel` |
| 7 | Shows | `shows` |
| 8 | Comedy | `comedy` |
| 9 | Anime | `anime-comics` |
| 10 | Beauty Care | `beauty-style` |
| 11 | Games | `gaming` |
| 12 | Cars | `auto-vehicle` |
| 13 | Food | `food-drink` |
| 14 | Animals | `pets` |
| 15 | Fitness & Health | `fitness-health` |
| 16 | Education | `education` |

### SAFHA-021: Topic Pipeline Must Flow End-to-End
- **Correct Flow**:
  ```
  rss_sources.topic_ids -> fetch-rss -> raw_articles.topic_ids -> process-articles -> stories.topic_ids
  ```
- **Recorded By**: The Eye

### SAFHA-022: Feed Debugging - Server vs Client Check
- **Lesson**: When feed shows fewer stories than expected:
  1. Check server: Query REST API directly
  2. Check database: Count approved stories
  3. Check client: Review query selection, topic filters
- **Diagnostic Script**: `supabase/DIAGNOSE_FEED.sql`

### SAFHA-023: Interests vs Explore Mode Query Differences
- **Interests mode**: `useUnseenStories` - filters out viewed/skipped
- **Explore mode**: `useStories` - all approved stories visible

### SAFHA-024: Feed Position Must Be Persisted
- **Fix**: Add `currentStoryIndex` to `partialize` in `stores/app.ts`
- **Files**: `stores/app.ts`, `app/(tabs)/feed.tsx`

### SAFHA-025: Anonymous Users Should See All Stories
- **Fix**: Removed `localHistory` filter for anonymous users
- **File**: `hooks/useStories.ts`

### SAFHA-026: Keep SQL ORDER BY Simple
- **Fix**: Simple `published_at DESC NULLS LAST, created_at DESC` instead of complex tiering

### SAFHA-027: pg_cron current_setting() Doesn't Work with pg_net
- **Fix**: Use literal JSON string instead of `current_setting()`:
  ```sql
  headers := '{"x-function-secret": "your-secret"}'::jsonb
  ```

### SAFHA-028: Edge Functions via pg_net Need BOTH Headers
- **Required Headers**:
  1. `x-function-secret` - custom validation
  2. `Authorization: Bearer <service_role_key>` - Supabase auth

### SAFHA-029: Sort by created_at Not published_at
- **Reason**: RSS feeds include old articles. `created_at` = when Safha processed it.
- **Fix**: `ORDER BY created_at DESC, published_at DESC`

### SAFHA-030: Google News RSS Provides Redirect URLs
- **Fix**: Added `resolveGoogleNewsUrl()` function to follow redirects
- **File**: `supabase/functions/fetch-rss/index.ts`

### SAFHA-031: Google News Articles Need Actual URL
- **Pattern**: Always check if URL is a redirect/aggregator before extracting content

### SAFHA-032: useMemo Dependencies
- **Fix**: Only include data that affects output, not `isLoading`/`isError`
- **File**: `app/(tabs)/feed.tsx`

### SAFHA-033: Single State for Image Fallback
- **Pattern**: Use state machine instead of multiple booleans
- **File**: `components/feed/StoryCard.tsx`

### SAFHA-034: Debounce Image Prefetch
- **Fix**: 300ms debounce, reduced prefetch count from 3 to 2

### SAFHA-035: Animation Loops Must Have Limits
- **Pattern**: (1) isMounted check, (2) iteration limit, (3) cleanup on unmount

### SAFHA-036: Clamp PagerView initialPage
- **Fix**: `Math.min(Math.max(0, currentStoryIndex), stories.length - 1)`

### SAFHA-037: External API Calls Need Timeout
- **Fix**: Use AbortController with 30-second timeout
- **File**: `supabase/functions/process-articles/index.ts`

### SAFHA-038: Auto-Reset Stuck Processing Articles
- **Fix**: Reset articles stuck in "processing" for >5 minutes at start of each run

### SAFHA-039: Keep Edge Function Batch Sizes Small
- **Fix**: Default 10 (not 25), max 20 (not 50) - stay under 60s timeout

### SAFHA-040: All Topics Need RSS Sources
- **Migration**: `20260116000007_assign_all_source_topics.sql`

### SAFHA-041: WhatsApp Business API Requires Meta Verification
- **Required**: Business registration, Tax ID, Meta Business verification (1-3 days)

### SAFHA-042: Taqnyat API Key Location
- **Path**: Portal Dashboard -> Developers -> Applications -> Create App -> Bearer Token

### SAFHA-043: MVP Alternatives to WhatsApp
| Method | Setup Time | Docs Required |
|--------|------------|---------------|
| Push Notifications | Done | None |
| Email (Resend) | 5 mins | None |
| SMS (Taqnyat) | 10 mins | None |
| WhatsApp | Days | Business docs |

### SAFHA-044: Twilio WhatsApp Sandbox Mode
- **Advantage**: Test immediately without business verification

### SAFHA-045: TAQNYAT_API_KEY Required
- **File**: `supabase/functions/generate-digest/index.ts`

### SAFHA-046: Profile Requirements for WhatsApp Digest
- `profile.phone_number` - with country code
- `profile.whatsapp_opted_in` - true
- `profile.notification_preferences.weekly_summary` - true

### SAFHA-047: Custom Memo Comparator for Object Props
- **Fix**: Compare VALUES not references:
  ```typescript
  function arePropsEqual(prev, next) {
    return prev.colors.primary === next.colors.primary;
  }
  ```

### SAFHA-048: One-Time Sync Pattern for Switch Components
- **Fix**: Use `hasLoadedPrefs` ref to sync only once on mount
- **File**: `app/(tabs)/profile.tsx`

### SAFHA-049: Verify Database Schema Matches Code
- **Context**: `process-articles` Edge Function crashed silently for 24+ hours because it referenced `raw_articles.updated_at` column that didn't exist
- **Lesson**: Before marking any feature "resolved", verify the actual database schema matches what the code expects
- **Fix**: Created migration `20260117000001_add_raw_articles_updated_at.sql`
- **Recorded By**: The Eye

### SAFHA-050: Monitor Cron Job Execution
- **Context**: Cron jobs were silently failing, no visibility into pipeline health
- **Lesson**: Query `cron.job_run_details` table to detect cron failures
- **Pattern**: `SELECT * FROM cron.job_run_details ORDER BY end_time DESC LIMIT 10;`
- **Fix**: Added `get_pipeline_health()` RPC that checks cron status

### SAFHA-051: Circuit Breaker Pattern for Cascade Prevention
- **Context**: When Claude API fails, consecutive failures can exhaust rate limits and cause extended outages
- **Lesson**: Implement circuit breaker that trips after N consecutive failures, with cooldown period
- **Pattern**:
  1. Track consecutive failures in `pipeline_config` table
  2. After 5 failures, "open" the circuit (stop processing)
  3. 30-minute cooldown before auto-retry
  4. Any success resets the failure counter
- **Files**: `supabase/migrations/20260117000003_pipeline_resilience.sql`, `supabase/functions/process-articles/index.ts`

### SAFHA-052: Health Check Endpoints for External Monitoring
- **Context**: No way to detect pipeline outages externally
- **Lesson**: Create health check endpoint that returns status for UptimeRobot, Pingdom, etc.
- **Response Format**:
  ```json
  {
    "status": "healthy|degraded|unhealthy",
    "timestamp": "...",
    "checks": {
      "database": true,
      "circuit_breaker_open": false,
      "stuck_articles": 0
    }
  }
  ```
- **File**: `supabase/functions/health-check/index.ts`

### SAFHA-053: Trust Automated Pipelines
- **Context**: After fixing process-articles Edge Function, operator manually triggered 17+ batches to "clear backlog faster" when cron job would have handled it in 4-5 hours
- **Lesson**: For automated batch processing systems:
  1. Deploy the fix
  2. Wait for cron to process naturally
  3. Monitor via SQL queries
  4. Only manually trigger if there's a business-critical deadline
- **Principle**: "Faster" â‰  "necessary". Automated systems are designed to self-heal.
- **Recorded By**: m7zm (CEO)

### SAFHA-054: Safha is Arabic-Only
- **Context**: CEO Mohammad decided to focus Safha exclusively on Arabic content for Saudi market
- **Decision**: Disable all English RSS sources
- **Rationale**:
  1. Target market: Saudi professionals
  2. Clearer positioning: Arabic news app
  3. Simpler content curation
- **Action**: Run `supabase/DISABLE_ENGLISH_SOURCES.sql` to disable 26 English sources
- **Recorded By**: m7zm (CEO) - 2026-01-19

### SAFHA-055: Remove Unused AI Output Fields for Cost Savings
- **Context**: AI summarization was generating bilingual content (English summaries + "Why it matters" in both languages) even though Safha only uses Arabic
- **Lesson**: Audit AI prompt outputs to ensure every field is actually used. Unused fields = wasted tokens = wasted money.
- **Changes**:
  1. Removed `summary_en`, `why_it_matters_ar`, `why_it_matters_en` from AI prompts
  2. Updated `AISummaryResponse` interface to only include `summary_ar`, `quality_score`, `topics`
  3. Frontend always uses `summary_ar` regardless of language setting
- **Cost Impact**:
  | Metric | Before | After | Savings |
  |--------|--------|-------|---------|
  | Output tokens/article | ~400 | ~150 | **62%** |
  | Cost/article | ~$0.01 | ~$0.006 | **40%** |
  | Articles per $20 | ~2,000 | ~3,300 | **+65%** |
- **Files Modified**:
  - `supabase/functions/summarize-story/index.ts`
  - `supabase/functions/process-articles/index.ts`
  - `lib/ai/summarize.ts`
  - `types/index.ts`
  - `components/feed/StoryCard.tsx`
  - `app/story/[id].tsx`
  - `app/topic/[id].tsx`
  - `lib/api.ts`
- **Backwards Compatible**: Existing columns remain, old articles keep English content, new articles just don't populate them
- **Recorded By**: Claude - 2026-01-20

---

## The Eye Observations

| Date | Observation | Severity | Status |
|------|-------------|----------|--------|
| 2026-01-12 | Pricing inconsistency (SAR 16 vs 25) caught | Medium | Resolved |
| 2026-01-12 | Fake social proof "32,000+" flagged | Critical | Resolved |
| 2026-01-15 | 73 Arabic RSS URLs added without testing - 42 were broken | High | Resolved |
| 2026-01-15 | `rss_sources` table was empty causing no stories | Critical | Resolved |
| 2026-01-15 | 10 English RSS sources broken (404/403/timeout) | Medium | Resolved |
| 2026-01-14 | Images zoomed too much with cover mode | Medium | Resolved |
| 2026-01-14 | Videos in article HTML not being extracted | Medium | Resolved |
| 2026-01-14 | 150+ console.* statements in production code | Critical | Resolved |
| 2026-01-14 | StoryCard buttons missing accessibility labels | High | Resolved |
| 2026-01-14 | SQL injection risk in fetch-rss | Critical | Resolved |
| 2026-01-14 | CORS set to `*` in edge function | High | Resolved |
| 2026-01-14 | 275 temp files polluting repository | Low | Resolved |
| 2026-01-15 | Explore feed had TWO filter layers blocking stories | High | Resolved |
| 2026-01-15 | @expo-google-fonts required network | Medium | Resolved |
| 2026-01-15 | app.json "output": "static" caused SSR crash | High | Resolved |
| 2026-01-15 | Windows Firewall blocking Expo Metro server | Medium | Resolved |
| 2026-01-15 | Explore empty state wrong message | Medium | Resolved |
| 2026-01-15 | RSS pipeline not processing - secrets missing | Critical | Resolved |
| 2026-01-15 | process-articles cron job never set up | Critical | Resolved |
| 2026-01-15 | pg_net can't use app.settings directly | High | Resolved |
| 2026-01-15 | 52 sources disabled during testing | High | Documented |
| 2026-01-15 | Topic pipeline broken - topic_ids not flowing | Critical | Verified Working |
| 2026-01-16 | 7 articles stuck in "processing" 30+ minutes | Critical | Resolved |
| 2026-01-16 | Claude API call had no timeout | Critical | Resolved |
| 2026-01-16 | Batch size 25 too large for 60s limit | High | Resolved |
| 2026-01-16 | ~25 direct RSS sources had no topic_ids | High | Resolved |
| 2026-01-16 | 5 topics only have Google News feeds | Medium | Documented |
| 2026-01-16 | API cost tracking added | Low | Completed |
| 2026-01-16 | User reports only 1 story - client-side issue | High | Resolved |
| 2026-01-16 | Anonymous feed showing 1 story | Critical | Resolved |
| 2026-01-16 | Feed position resetting on navigation | Critical | Resolved |
| 2026-01-16 | Old stories showing first | Critical | Resolved |
| 2026-01-16 | process-articles cron returning 401 | Critical | Resolved |
| 2026-01-16 | 936 raw_articles stuck pending | Critical | Resolved |
| 2026-01-16 | Google News stories showing no images | Critical | Resolved |
| 2026-01-16 | App glitching - 8 performance issues fixed | Critical | Resolved |
| 2026-01-16 | Topic cards requiring multiple taps | High | Resolved |
| 2026-01-16 | WhatsApp share button glitching | Medium | Resolved |
| 2026-01-16 | WhatsApp digest switch reverting | High | Resolved |
| 2026-01-16 | WhatsApp digest not sending - API key missing | Medium | Documented |
| 2026-01-16 | All WhatsApp providers require Meta verification | Medium | Documented |
| 2026-01-17 | process-articles crashing - raw_articles.updated_at column missing | Critical | Resolved |
| 2026-01-17 | No pipeline monitoring - cron failures went undetected for 24h+ | Critical | Resolved |
| 2026-01-17 | No circuit breaker - failures could cascade indefinitely | High | Resolved |
| 2026-01-17 | No health check endpoint for external monitoring | High | Resolved |
| 2026-01-19 | Operator manually triggered pipeline 17+ times instead of waiting for cron | Medium | Documented |
| 2026-01-20 | AI prompt generating unused bilingual content - 62% wasted output tokens | High | Resolved |
